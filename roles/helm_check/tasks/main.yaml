---
- name: Check Helm availability
  ansible.builtin.command: helm version --short
  register: _helm_probe
  failed_when: false

- name: Report Helm version to TTY (if installed)
  ansible.builtin.debug:
    msg: "OK (%s) {{ _helm_probe.stdout }}"
  when: _helm_probe.rc == 0

- name: Print Helm missing/error message and exit (if not installed)
  ansible.builtin.fail:
    msg: |
      ERROR:
          Helm is not installed or not on PATH.
          Hint: Install Helm 3 and ensure 'helm' is resolvable.
  when: _helm_probe.rc != 0
